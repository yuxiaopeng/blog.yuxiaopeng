<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Roc's Blog]]></title>
  <link href="http://yuxiaopeng.github.com/atom.xml" rel="self"/>
  <link href="http://yuxiaopeng.github.com/"/>
  <updated>2014-04-02T10:14:49+08:00</updated>
  <id>http://yuxiaopeng.github.com/</id>
  <author>
    <name><![CDATA[Roc]]></name>
    <email><![CDATA[uxiaopeng@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[setup-and-configuration-hadoop-environment]]></title>
    <link href="http://yuxiaopeng.github.com/blog/2014/04/02/setup-and-configuration-hadoop-environment/"/>
    <updated>2014-04-02T09:06:00+08:00</updated>
    <id>http://yuxiaopeng.github.com/blog/2014/04/02/setup-and-configuration-hadoop-environment</id>
    <content type="html"><![CDATA[<p><img src="http://yuxiaopeng.github.com/images/2014/04/hadoop-elephant_logo.png"></p>

<h3>1.环境准备</h3>

<p>三台服务器：CentOS6.5系统
IP地址如下，分别配置/etc/hosts：</p>

<p>`10.2.15.12  master</p>

<p>10.2.15.13  slave1</p>

<p>10.2.15.14  slave2`</p>

<p>JDK安装及Java环境配置</p>

<p>下载tar包，解压到/apps/目录</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>chown -R root.root jdk1.7.0_51   # 授权</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vi /etc/profile   # 配置环境变量
</span><span class='line'>export JAVA_HOME=/apps/jdk1.7.0_51
</span><span class='line'>export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
</span><span class='line'>export PATH=$PATH:$JAVA_HOME/bin
</span><span class='line'>source /etc/profile  # 使修改生效</span></code></pre></td></tr></table></div></figure>


<p>更新 alternatives，选择JDK版本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>update-alternatives --install /usr/bin/java java /apps/jdk1.7.0_51/bin/java 60
</span><span class='line'>update-alternatives --config java</span></code></pre></td></tr></table></div></figure>


<p>选择3回车</p>

<p>创建hadoop用户</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>groupadd hadoop   # 添加组
</span><span class='line'>useradd -g hadoop -d /home/hadoop hadoop   # 添加用户
</span><span class='line'>passwd hadoop   # 修改密码</span></code></pre></td></tr></table></div></figure>


<p>SSH无密码验证配置</p>

<p>master执行，</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir ~/.ssh
</span><span class='line'>su - hadoop
</span><span class='line'>cd ~/.ssh
</span><span class='line'>ssh-keygen -t  rsa       # 一直回车生成密钥
</span><span class='line'>cat id_rsa.pub &gt;&gt; authorized_keys   # 将公钥id_rsa.pub追加到授权的key里面去
</span><span class='line'>svervice sshd restart   # 重启SSH服务
</span><span class='line'>ssh slave1   # ssh到slave1
</span><span class='line'>mkdir ~/.ssh   # 创建.ssh目录
</span><span class='line'>ssh slave2   # ssh到slave2
</span><span class='line'>mkdir ~/.ssh   # 创建.ssh目录
</span><span class='line'>exit
</span><span class='line'>exit    # 返回到master
</span><span class='line'>scp authorized_keys slave1:~/.ssh/   # copy授权key到slave1
</span><span class='line'>scp authorized_keys slave2:~/.ssh/   # copy授权key到slave2
</span><span class='line'>vi /etc/ssh/sshd_config   #开启RSA认证
</span><span class='line'>RSAAuthentication yes
</span><span class='line'>PubkeyAuthentication yes
</span><span class='line'>AuthorizedKeysFile      .ssh/authorized_keys
</span><span class='line'>ssh slave1   # ssh到slave1
</span><span class='line'>chmod 700 ~/.ssh #目录权限必须设置700
</span><span class='line'>ssh slave2   # ssh到slave2
</span><span class='line'>chmod 700 ~/.ssh #目录权限必须设置700
</span><span class='line'>exit
</span><span class='line'>exit    # 返回到master
</span><span class='line'>ssh salve1   # 验证
</span><span class='line'>exit
</span><span class='line'>ssh slave2   # 验证</span></code></pre></td></tr></table></div></figure>


<h3>2.安装与配置</h3>

<p><a href="http://www.apache.org/dyn/closer.cgi/hadoop/common/"><code>下载hadoop-2.2.0</code></a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir /apps/hadoop  # 创建hadoop目录作为安装hadoop的home目录
</span><span class='line'>tar zxvf hadoop-2.2.0.tar.gz -C /apps/hadoop   # 解压到hadoop目录
</span><span class='line'>chown hadoop.hadoop -R /home/hadoop/hadoop-2.3.0/   # 授权
</span><span class='line'>vi /etc/profile   #添加hadoop变量，方便使用，不必每次操作cd到bin目录
</span><span class='line'>HADOOP_HOME=/home/hadoop/hadoop-2.2.0/
</span><span class='line'>PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin
</span><span class='line'>export HADOOP_HOME PATH
</span><span class='line'>source /etc/profile   # 生效</span></code></pre></td></tr></table></div></figure>


<p>修改hadoop-env.sh、yarn-env.sh环境变量</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vi hadoop-env.sh
</span><span class='line'>export JAVA_HOME=/apps/jdk1.7.0_51
</span><span class='line'>vi yarn-env.sh 
</span><span class='line'>export JAVA_HOME=/apps/jdk1.7.0_51</span></code></pre></td></tr></table></div></figure>


<p>修改core-site.xml配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;configuration&gt;
</span><span class='line'>  &lt;property&gt;
</span><span class='line'>      &lt;name&gt;fs.default.name&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;hdfs://master:9000/&lt;/value&gt;
</span><span class='line'>      &lt;description&gt;The name of the default file system. A URI whose scheme and authority determine the FileSystem implementation. The uri's scheme determines the config property (fs.SCHEME.impl) naming the FileSystem implementation class. The uri's authority is used to determine the host, port, etc. for a filesystem.&lt;/description&gt;
</span><span class='line'>  &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>      &lt;name&gt;io.file.buffer.size&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;131072&lt;/value&gt;
</span><span class='line'>  &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;/apps/hadoop/tmp&lt;/value&gt;
</span><span class='line'>        &lt;description&gt;A base for other temporary directories.&lt;/description&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;hadoop.proxyuser.hduser.hosts&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;*&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;hadoop.proxyuser.hduser.groups&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;*&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>&lt;/configuration&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改hdfs-site.xml配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;configuration&gt;
</span><span class='line'>  &lt;property&gt;
</span><span class='line'>      &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;file://${hadoop.tmp.dir}/dfs/name&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;file://${hadoop.tmp.dir}/dfs/data&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;/apps/hadoop/hdfs/tmp/&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;dfs.replication&lt;/name&gt;   #数据副本数量，默认3，我们是两台设置2
</span><span class='line'>        &lt;value&gt;2&lt;/value&gt;    
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;true&lt;/value&gt;
</span><span class='line'>     &lt;/property&gt;
</span><span class='line'>&lt;/configuration&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改mapred-site.xml配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;configuration&gt;
</span><span class='line'>  &lt;property&gt;
</span><span class='line'>      &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;yarn&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>      &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;master:10020&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>    &lt;property&gt;
</span><span class='line'>        &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
</span><span class='line'>        &lt;value&gt;master:19888&lt;/value&gt;
</span><span class='line'>    &lt;/property&gt;
</span><span class='line'>&lt;configuration&gt;</span></code></pre></td></tr></table></div></figure>


<p>修改slaves配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>slave1
</span><span class='line'>slave2</span></code></pre></td></tr></table></div></figure>


<p>修改yarn-site.xml配置文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;configuration&gt;
</span><span class='line'>  &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.resourcemanager.address&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;master:8032&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.resourcemanager.scheduler.address&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;master:8030&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.resourcemanager.resource-tracker.address&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;master:8031&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.resourcemanager.admin.address&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;master:8033&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;master:8088&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>      &lt;property&gt;
</span><span class='line'>      &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;
</span><span class='line'>      &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;
</span><span class='line'>      &lt;/property&gt;
</span><span class='line'>&lt;/configuration&gt;</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp hadoop slave1:~/apps/   # 复制到其他节点slave1、slave2
</span><span class='line'>scp hadoop slave2:~/apps/</span></code></pre></td></tr></table></div></figure>


<p>注意：只需要原样复制即可，不必改动上面的xml配置文件。</p>

<h3>3.启动关闭与验证</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hdfs namenode -format   #
</span><span class='line'>start-dfs.sh   # 启动HDFS文件系统
</span><span class='line'>jps   # 检查守护进程是否启动
</span><span class='line'>start-yarn.sh   # 启动新mapreduce架构
</span><span class='line'>jps   # 检查守护进程是否启动
</span><span class='line'>start-all.sh   # 也可通过star-all.sh启动所有进程
</span><span class='line'>stop-all.sh   # 关闭所有进程
</span><span class='line'>hdfs dfsadmin -report # 查看集群状态</span></code></pre></td></tr></table></div></figure>


<p>浏览器中查看</p>

<p>http://master:8088   #通过web查看资源</p>

<p>http://master:50070   # 查看HDFS状态</p>

<p>参考：<a href="http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/ClusterSetup.html"><code>Hadoop Cluster Setup</code></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ocotopress个性化配置]]></title>
    <link href="http://yuxiaopeng.github.com/blog/2014/02/11/ocotopress-personalized-configuration/"/>
    <updated>2014-02-11T14:51:00+08:00</updated>
    <id>http://yuxiaopeng.github.com/blog/2014/02/11/ocotopress-personalized-configuration</id>
    <content type="html"><![CDATA[<p><img src="http://yuxiaopeng.github.com/images/2014/02/octopress.png"></p>

<h3>1、添加个人域名</h3>

<p>octopress目录下，执行命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo 'yourdomain.com' &gt;&gt; source/CNAME</span></code></pre></td></tr></table></div></figure>


<p>此命令会在octopress的source目录创建一个名为CNAME的文件文件，内容为<code>yourdomain.com</code>，完成之后，执行如下命令将CNAME部署到github：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>git add .
</span><span class='line'>git commit -am "add CNAME." 
</span><span class='line'>git push origin source
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>然后在你的DNS服务商，如 dnspod.cn，添加相应的CNAME指向 <code>yourname.github.com</code>。如果你要使用顶级域名，如 <a href="http://yuxiaopeng.com"><code>http://yuxiaopeng.com</code></a> 访问你的博客，则需要使用A记录指向 <code>204.232.175.78</code>。</p>

<p>详细内容请参考：<a href="http://octopress.org/docs/deploying/github/"><code>Custom Domains</code></a></p>

<h3>2、安装主题</h3>

<p>本博使用shashank的greyshade主题，在终端中执行如下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone git@github.com:shashankmehta/greyshade.git .themes/greyshade
</span><span class='line'>$ echo "\$greyshade: color;" &gt;&gt; sass/custom/_colors.scss //Substitue 'color' with your highlight color
</span><span class='line'>$ rake "install[greyshade]"
</span><span class='line'>$ rake generate</span></code></pre></td></tr></table></div></figure>


<p>然后，部署到github：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>git add .
</span><span class='line'>git commit -am "install greyshade." 
</span><span class='line'>git push origin source
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>详细内容请参考：<a href="https://github.com/shashankmehta/greyshade"><code>greyshade</code></a></p>

<h3>3、添加多说</h3>

<ul>
<li>获取short_name</li>
</ul>


<p>去 <a href="http://duoshuo.com"><code>多说网</code></a> 注册账号，并获取站点的short_name</p>

<ul>
<li>在_config.yml文件中添加如下内容</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># duoshuo comments
</span><span class='line'>duoshuo_comments: true
</span><span class='line'>duoshuo_short_name: yourname</span></code></pre></td></tr></table></div></figure>


<ul>
<li>在source/_layouts/post.html中添加多说评论模块</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>｛% if site.duoshuo_short_name and site.duoshuo_comments == true and page.comments == true %｝
</span><span class='line'>  &lt;section&gt;
</span><span class='line'>    &lt;h1&gt;Comments&lt;/h1&gt;
</span><span class='line'>    &lt;div id="comments" aria-live="polite"&gt;｛% include post/duoshuo.html %｝&lt;/div&gt;
</span><span class='line'>  &lt;/section&gt;
</span><span class='line'>｛% endif %｝</span></code></pre></td></tr></table></div></figure>


<ul>
<li>创建source/_includes/post/duoshuo.html，并填入如下内容</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- Duoshuo Comment BEGIN --&gt;
</span><span class='line'>&lt;div class="ds-thread"&gt;&lt;/div&gt;
</span><span class='line'>&lt;script type="text/javascript"&gt;
</span><span class='line'>  var duoshuoQuery = {short_name:"yuxiaopeng"};
</span><span class='line'>  (function() {
</span><span class='line'>    var ds = document.createElement('script');
</span><span class='line'>    ds.type = 'text/javascript';ds.async = true;
</span><span class='line'>    ds.src = 'http://static.duoshuo.com/embed.js';
</span><span class='line'>    ds.charset = 'UTF-8';
</span><span class='line'>    (document.getElementsByTagName('head')[0] 
</span><span class='line'>    || document.getElementsByTagName('body')[0]).appendChild(ds);
</span><span class='line'>  })();
</span><span class='line'>&lt;/script&gt;
</span><span class='line'>&lt;!-- Duoshuo Comment END --&gt;</span></code></pre></td></tr></table></div></figure>


<ul>
<li>发布到站点</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake generate
</span><span class='line'>$ git add .
</span><span class='line'>$ git commit -am "添加多说评论" 
</span><span class='line'>$ git push origin source
</span><span class='line'>$ rake deploy</span></code></pre></td></tr></table></div></figure>


<h3>4、添加百度和Google统计</h3>

<p>从百度统计获取脚本，然后添加到文件<code>source/_includes/after_footer.html</code>文件中
从google analytics获取跟踪ID，然后将这个ID添加到<code>_config.yml</code>文件的<code>google_analytics_tracking_id</code>后面即可。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Google Analytics
</span><span class='line'>google_analytics_tracking_id: UA-457s202x-x</span></code></pre></td></tr></table></div></figure>


<p>持续更新</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用Octopress搭建博客]]></title>
    <link href="http://yuxiaopeng.github.com/blog/2014/02/10/create-a-blog-using-octopress/"/>
    <updated>2014-02-10T16:17:00+08:00</updated>
    <id>http://yuxiaopeng.github.com/blog/2014/02/10/create-a-blog-using-octopress</id>
    <content type="html"><![CDATA[<p><img src="http://yuxiaopeng.github.com/images/2014/02/github_page_and-octopress.png"></p>

<h3>1、安装 Git.</h3>

<p>Mac系统默认已安装<a href="http://git-scm.com"><code>Git</code></a>.在终端输入git &#8211;version，应该可以看到电脑中的git版本</p>

<h3>2、安装 Ruby</h3>

<p>Octopress需要Ruby环境，RVM(Ruby Version Manager)负责安装和管理Ruby的环境。我们先在Terminal中输入如下命令，来安装RVM：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -L https://get.rvm.io | bash -s stable —ruby</span></code></pre></td></tr></table></div></figure>


<p>接着安装Ruby 1.9.3，在终端依次运行如下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rvm install 1.9.3
</span><span class='line'>rvm use 1.9.3
</span><span class='line'>rvm ruby gems latest</span></code></pre></td></tr></table></div></figure>


<p>完成上面的操作之后，运行ruby &#8211;version应该可以看到ruby 1.9.3环境已经安装好了。</p>

<p>参考  <a href="http://octopress.org/docs/setup/rvm/"><code>Installing Ruby With RVM</code></a></p>

<h3>3、安装 Octopress</h3>

<p>使用用git命令将octopress从github上clone到本机，如下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'>cd octopress    # If you use RVM, You'll be asked if you trust the .rvmrc file (say yes).
</span><span class='line'>ruby --version  # Should report Ruby 1.9.3</span></code></pre></td></tr></table></div></figure>


<p>安装相关依赖项：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem install bundler
</span><span class='line'>rbenv rehash    # If you use rbenv, rehash to be able to run the bundle command
</span><span class='line'>bundle install</span></code></pre></td></tr></table></div></figure>


<p>最后安装默认的Octopress 主题。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> rake install</span></code></pre></td></tr></table></div></figure>


<p>参考：<a href="http://octopress.org/docs/setup/"><code>Octopress Setup</code></a></p>

<h3>4、部署到Github Pages</h3>

<p>创建一个新的Github仓库，并以username.github.com命名 ，其中username是你的GitHub上的用户名或组织名称命名的存储库。</p>

<p>为了通过url username.github.com访问到我们github pages页面，需要将源码文件提交到Source分支，将生成好的内容提交到Master分支。 Octopress有一个配置可以实现这些。 在终端输入如下命令：
rake setup_github_pages</p>

<p>此命令会要求你输入仓库的url，根据提示，进行输入即可。这个命令将实现如下操作：</p>

<p>1、询问和存储您的Github Pages仓库的URL</p>

<p>2、重命名远程仓库imathis/octopress 的 &#8216;origin’ 为 &#8216;octopress’</p>

<p>3、将Github Pages仓库设置为默认的远程origin分支</p>

<p>4、将活动分支由master切换为source</p>

<p>5、根据存储库配置你的博客的url</p>

<p>6、创建一个_deploy目录，用来存放部署到master分支的内容</p>

<p>接下来执行命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>上面的命令首先生成博客文件，并将生成的博客文件拷贝到_deploy/目录下，然后将这些内容添加到git中，并commit和push到仓库的master分支。</p>

<p>现在可以访问http://username.github.com了。注意：有时候可能会有延时，要等几分钟才能打开。
至此，我们的博客已经完成基本的部署。</p>

<p>不要忘记提交source目录,执行如下命令就可以将source提交到仓库的source分支下。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git add .
</span><span class='line'>git commit -m 'your message'
</span><span class='line'>git push origin source</span></code></pre></td></tr></table></div></figure>


<p>参考：<a href="http://octopress.org/docs/deploying/github/"><code>Deploying to Github Pages</code></a></p>

<h3>5、配置 Octopress</h3>

<p>Octopress大多数情况下只需要配置<code>_config.yml</code>和<code>Rakefile</code>文件即可。其中Rakefile是跟博客部署相关，一般情况下并不需要修改这个文件。</p>

<p>config.yml是博客重要的一个配置文件，在config.yml文件中有三大配置项：<code>Main Configs</code>、<code>Jekyll &amp; Plugins</code>和<code>3rd Party Settings</code>。</p>

<p>一般，该文件中其中<code>url</code>是必须要填写的，这里的url是在github上创建的仓库地址。另外再修改一下<code>title</code>,<code>subtitle</code>,<code>author</code>，根据需求，开启一些第三方组件服务。</p>

<p>注意格式: 配置项:＋空格＋参数，空格一定不能少，否则会报错。</p>

<ul>
<li>配置日期格式</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>date_format: "%F %a"         #2014-01-01    
</span><span class='line'>date_format: "%Y年%m月%d日"    #2014年1月1日</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Jekyll配置</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>excerpt_link: "继续阅读 &amp;rarr; "
</span><span class='line'>permalink: /blog/:title.html/</span></code></pre></td></tr></table></div></figure>


<ul>
<li>侧边栏</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>default_asides: [asides/recent_posts.html, asides/github.html]</span></code></pre></td></tr></table></div></figure>


<ul>
<li>使用本地时区</li>
</ul>


<p>将Rakefile里面所有Time.now改为Time.now.localtime</p>

<ul>
<li>自动打开文件/浏览器（编辑Rakefile）</li>
</ul>


<p>rake new_post/page 后使用指定编辑器自动打开生成的文件</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Misc Configs 中添加，如果不需要自动打开，则直接使用""
</span><span class='line'>editor="open"
</span><span class='line'># open ,使用系统默认编辑器
</span><span class='line'># open -a Mou，使用Mou打开
</span><span class='line'># open -a Byword，使用Byword打开
</span><span class='line'># subl, 使用Sublime Text2打开 
</span><span class='line'>...
</span><span class='line'># task :new_post 和 task :new_page 中添加
</span><span class='line'>if #{editor}
</span><span class='line'>  system "sleep 1; #{editor} #{filename}"
</span><span class='line'>end
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>rake preview 自动打开浏览器</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># task :preview 一段中添加
</span><span class='line'>system "sleep 2; open http://localhost:#{server_port}/"</span></code></pre></td></tr></table></div></figure>


<p>参考：<a href="http://octopress.org/docs/configuring/"><code>Configuring Octopress</code></a></p>

<h3>6、开始使用Octopress写博客</h3>

<p>博客系统搭建好之后，如何撰写博文呢？通过之前的步骤想必你对octopress的精髓有所了解，没有所见即所得的编辑器让你撰写博文，你要做的是使用 rake new_post 命令创建一篇新的文章，然后使用称手的markdown编辑器进行编辑即可。可选择的markdown编辑器很多，vim，sublime text 2，textmate 2，mou等等。我个人喜欢在osx下使用sublime text 2。</p>

<p>终端中输入命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post["title"]</span></code></pre></td></tr></table></div></figure>


<p>Octopress博文存储在source/_posts目录下，按照Jekyll的命名规范对文章进行命名：YYYY-MM-DD-post-title.markdown。文章的名字会被当做url的一部分，而其中的日期用于对博文的区分和排序。打开这个文件内容如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>---
</span><span class='line'>layout: post
</span><span class='line'>title: "使用Octopress搭建博客"
</span><span class='line'>date: 2014-02-10 16:17
</span><span class='line'>comments: true
</span><span class='line'>categories: 
</span><span class='line'>---</span></code></pre></td></tr></table></div></figure>


<p>接着我们就可以在这个文件中写我们的博文啦。完成之后，我们可以预览和部署博文。下面是创建并部署博文的一个完整过程：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post["New Post"]
</span><span class='line'>rake generate
</span><span class='line'>rake preview
</span><span class='line'>git add .
</span><span class='line'>git commit -am "Some comment here." 
</span><span class='line'>git push origin source
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>参考：<a href="http://octopress.org/docs/blogging/"><code>Blogging Basics</code></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello Github Pages]]></title>
    <link href="http://yuxiaopeng.github.com/blog/2013/11/18/hello-github-pages/"/>
    <updated>2013-11-18T11:56:00+08:00</updated>
    <id>http://yuxiaopeng.github.com/blog/2013/11/18/hello-github-pages</id>
    <content type="html"><![CDATA[<p><img src="http://yuxiaopeng.github.com/images/2013/11/octopress-logo.png"></p>

<h3>大家好，我是Roc，欢迎大家关注我的小站！</h3>

<p><code>博客</code>-><code>托管博客</code>-><code>wordpress</code>-><code>octopress</code><br>建博后第一篇文章，就说说创建这个Blog的过程吧。最初接触博客这个概念是在2007年左右，那时候网吧很流行，而去网吧能干的事无非是玩游戏、聊QQ、浏览网页，我不是一个对游戏能够痴迷的人，浏览网页的过程中发现了51，后来才知道这不是偶然，51在一线城市可能没多少人用，但三线及以下城市很多人用51。在51你会发现博客中展示更多的不是文章而是照片，用户中多半是年轻女性，这可能是51抓住了年轻女性喜欢展示自己漂亮照片的心理。51让我知道了博客这个概念，后来陆陆续续使用了Blogger、新浪博客、搜狐博客、博客中国、QQ空间等。2010年左右经常逛一些技术论坛，知道了独立博客的概念，区别于托管博客，独立博客有自己的空间、域名，更自由、灵活，不受限制，典型代表是wordpress。于是研究之，中间搭建过几个博客，也尝试自己做过wordpress主题，但这也只是对wordpress的相关技术的了解，并没有利用到它强大的文章功能，这也是不能坚持写博客的原因。2012年认识了Github，经常去Fork一些代码学习，后来知道了Page,发现竟然有如此强大的博客系统,最终在2013年初创建了这个博客，拖到现在才写了这第一篇文章。下面是我创建博客的过程：</p>

<h3>搭建Octopress</h3>

<h3>1.安装 ruby</h3>

<p>下载地址: <a href="http://rubyforge.org/frs/?group_id=167"><code>RubyInstaller</code></a>，最新版本 rubyinstaller-1.9.3-p429.exe，注意版本是1.9.3。</p>

<h3>2.安装 gem</h3>

<p>下载地址: <a href="http://rubyinstaller.org/downloads/"><code>gem</code></a>，与1.9.3对应版本为 DevKit-tdm-32-4.5.2-20111229-1559-sfx.exe，解压到D:/DevKit,cmd中执行：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd D:\DevKit
</span><span class='line'>ruby dk.rb init
</span><span class='line'>ruby dk.rb instal</span></code></pre></td></tr></table></div></figure>


<h3>3.安装 python</h3>

<p>下载地址：<a href="http://www.activestate.com/activepython/downloads"><code>activepython</code></a> ，安装2.7版，博客代码加亮模块需要python环境的支持，安装完以后，在win的cmd窗口中执行：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>easy_install pygments</span></code></pre></td></tr></table></div></figure>


<p>win7环境变量：<br>
LANG=zh_CN.UTF-8
LC_ALL=zh_CN.UTF-8</p>

<p>更新gem源:<br></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem sources --remove http://rubygems.org/
</span><span class='line'>gem sources -a http://ruby.taobao.org/
</span><span class='line'>gem sources -l</span></code></pre></td></tr></table></div></figure>


<p>注意 ：请确保只有 http://ruby.taobao.org/ 唯一一个条目</p>

<p>安装 rdoc 和 bundler:<br>
gem install rdoc bundler</p>

<h3>4.安装 Octopress</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'>bundle install
</span><span class='line'>rake install</span></code></pre></td></tr></table></div></figure>


<h3>5.发布到github pages</h3>

<p>与github建立连接:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake setup_github_pages</span></code></pre></td></tr></table></div></figure>


<p>按照提示输入 github page repository的url地址，例如：git@github.com:yuxiaopeng/yuxiaopeng.github.com.git</p>

<p>生成静态页面:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate</span></code></pre></td></tr></table></div></figure>


<p>本地预览，访问 http://localhost:4000 查看博客本地运行效果:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake preview</span></code></pre></td></tr></table></div></figure>


<p>部署到github 服务器：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
</feed>
